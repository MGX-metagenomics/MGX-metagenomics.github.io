<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2021.2 (Released July 1, 2021) -->
<HTML lang="en">
<HEAD>
<TITLE>Creating hierarchical attributes</TITLE>
<META NAME="description" CONTENT="Creating hierarchical attributes">
<META NAME="keywords" CONTENT="main">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2021.2">

<LINK REL="STYLESHEET" HREF="main.css">

<LINK REL="previous" HREF="node34.html">
<LINK REL="next" HREF="node36.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node36.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node34.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node34.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html240"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A
 HREF="node36.html">References</A>
<B> Up:</B> <A
 HREF="node34.html">Annotating metagenome sequences</A>
<B> Previous:</B> <A
 HREF="node34.html">Annotating metagenome sequences</A>
 &nbsp; <B>  <A ID="tex2html241"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00431000000000000000">
Creating hierarchical attributes</A>
</H2>

<P>
Annotation of hierarchical attributes requires a little more effort. The <SPAN  CLASS="texttt">CreateHierarchicalMGXAttribute</SPAN> node
is used to obtain the inner structure of the hierarchy in a bottom-up approach; It contains several loops which
will be explained in more detail.

<P>

<DIV class="CENTER"><A ID="annot5"></A><A ID="872"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 3.12:</STRONG>
The <SPAN  CLASS="texttt">CreateHierarchicalMGXAttribute</SPAN> node requires three loops (note double-ended arrow on third loop between nodes 99 and 79)
to create the internal structure of the hierarchy. Several connections were removed from the figure
for illustrative purposes.</CAPTION>
<TR><TD>
<DIV class="CENTER"><IMG
  WIDTH="621" HEIGHT="428" STYLE=""
 SRC="./TreeAnnot.png"
 ALT="Image TreeAnnot">
</DIV></TD></TR>
</TABLE>
</DIV>

<P>
A single object, e.g. a NCBI taxon generated by the Kraken [<A
 HREF="node36.html#KRAKEN">Wood and Salzberg, 2014</A>] classifier, is provided as an input
into the node (<A HREF="#annot5">3.12</A>). 
The first loop is required to obtain the objects parent object, thus defining the hierarchy. In this example
it is implemented using the <SPAN  CLASS="texttt">GetParent</SPAN> and <SPAN  CLASS="texttt">GetMajorRankedTaxon</SPAN> nodes, thus making sure only
the major taxonomic ranks (superkingdom, phylum, class, ...) are included.
<BR>
The second loop is used to obtain the corresponding attribute type for an object: it operates on the initial taxon as well as its parents
obtained by the first loop. <SPAN  CLASS="texttt">GetTaxonRank</SPAN> and <SPAN  CLASS="texttt">GetRankName</SPAN> nodes provide the corresponding
ranks' name, e.g. &ldquo;class&rdquo;; The <SPAN  CLASS="texttt">StringGenerator</SPAN> and <SPAN  CLASS="texttt">Concat</SPAN> nodes are then used to create the
attribute type: &ldquo;NCBI_class&rdquo;. This value is used to create the corresponding attribute type employing the
<SPAN  CLASS="texttt">CreateMGXAttributeType</SPAN> node, which is returned into the <SPAN  CLASS="texttt">CreateHierarchicalMGXAttribute</SPAN> node.
<BR>
The third and final loop is used to map a data object to its name, which is used to create the attributes value;
it is built up using the <SPAN  CLASS="texttt">GetTaxonName</SPAN> node, which delivers its output back into the node.
<BR>
<P>
Thus, the three loops might be termed as <SPAN  CLASS="textbf">Get parent</SPAN>, <SPAN  CLASS="textbf">Get AttributeType for object</SPAN> and
<SPAN  CLASS="textbf">Generate value</SPAN>. 

<P>
The <SPAN  CLASS="texttt">CreateHierarchicalMGXAttribute</SPAN> node emits a hierarchical MGXAttribute for the initial data object,
with the corresponding AttributeType provided by loop 2 and the MGXAttribute's value obtained using loop 3.
Internally, loop 1 is used repetitively until the root node is reached, with all intermediary results
passing through loops 2 and 3, thus generating a single path of hierarchical attributes within the taxonomic
tree. The output of the <SPAN  CLASS="texttt">CreateHierarchicalMGXAttribute</SPAN> is connected to the <SPAN  CLASS="texttt">AnnotateAttribute</SPAN>
node as in the previous example.

<P>
For brevity's sake, several connections are hidden within the image, which have already been explained in the
previous section; the <SPAN  CLASS="texttt">CreateMGXAttributeType</SPAN> node needs an incoming connection providing a MGXJob,
and the <SPAN  CLASS="texttt">AnnotateAttribute</SPAN> node requires additional connections providing the sequence to be annotated
and start/stop coordinates for the subregion which is described by the annotation.

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node36.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node34.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node34.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html240"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A
 HREF="node36.html">References</A>
<B> Up:</B> <A
 HREF="node34.html">Annotating metagenome sequences</A>
<B> Previous:</B> <A
 HREF="node34.html">Annotating metagenome sequences</A>
 &nbsp; <B>  <A ID="tex2html241"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Sebastian Jaenicke, 2024-02-18
</ADDRESS>
</BODY>
</HTML>
