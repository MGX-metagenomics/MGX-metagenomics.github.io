<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2018 (Released Feb 1, 2018) -->
<HTML>
<HEAD>
<TITLE>Creating hierarchical attributes</TITLE>
<META NAME="description" CONTENT="Creating hierarchical attributes">
<META NAME="keywords" CONTENT="main">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2018">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="main.css">

<LINK REL="previous" HREF="node33.html">
<LINK REL="up" HREF="node33.html">
<LINK REL="next" HREF="node35.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html559"
  HREF="node35.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html555"
  HREF="node33.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html551"
  HREF="node33.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html557"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html560"
  HREF="node35.html">Bibliography</A>
<B> Up:</B> <A NAME="tex2html556"
  HREF="node33.html">Annotating metagenome sequences</A>
<B> Previous:</B> <A NAME="tex2html552"
  HREF="node33.html">Annotating metagenome sequences</A>
 &nbsp; <B>  <A NAME="tex2html558"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00431000000000000000">
Creating hierarchical attributes</A>
</H2>

<P>
Annotation of hierarchical attributes requires a little more effort. The <TT>CreateHierarchicalMGXAttribute</TT> node
is used to obtain the inner structure of the hierarchy in a bottom-up approach; It contains several loops which
will be explained in more detail.

<P>

<DIV ALIGN="CENTER"><A NAME="annot5"></A><A NAME="866"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 3.12:</STRONG>
The <TT>CreateHierarchicalMGXAttribute</TT> node requires three loops (note double-ended arrow on third loop between nodes 99 and 79)
to create the internal structure of the hierarchy. Several connections were removed from the figure
for illustrative purposes.</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV><IMG
  WIDTH="991" HEIGHT="681" ALIGN="BOTTOM" BORDER="0"
 SRC="./TreeAnnot.png"
 ALT="Image TreeAnnot"></TD></TR>
</TABLE>
</DIV>

<P>
A single object, e.g. a NCBI taxon generated by the Kraken [<A
 HREF="node35.html#KRAKEN">Wood and Salzberg, 2014</A>] classifier, is provided as an input
into the node (<A HREF="#annot5">3.12</A>). 
The first loop is required to obtain the objects parent object, thus defining the hierarchy. In this example
it is implemented using the <TT>GetParent</TT> and <TT>GetMajorRankedTaxon</TT> nodes, thus making sure only
the major taxonomic ranks (superkingdom, phylum, class, ...) are included.
<BR>
The second loop is used to obtain the corresponding attribute type for an object: it operates on the initial taxon as well as its parents
obtained by the first loop. <TT>GetTaxonRank</TT> and <TT>GetRankName</TT> nodes provide the corresponding
ranks' name, e.g. &ldquo;class&rdquo;; The <TT>StringGenerator</TT> and <TT>Concat</TT> nodes are then used to create the
attribute type: &ldquo;NCBI_class&rdquo;. This value is used to create the corresponding attribute type employing the
<TT>CreateMGXAttributeType</TT> node, which is returned into the <TT>CreateHierarchicalMGXAttribute</TT> node.
<BR>
The third and final loop is used to map a data object to its name, which is used to create the attributes value;
it is built up using the <TT>GetTaxonName</TT> node, which delivers its output back into the node.
<BR>
<P>
Thus, the three loops might be termed as <SPAN  CLASS="textbf">Get parent</SPAN>, <SPAN  CLASS="textbf">Get AttributeType for object</SPAN> and
<SPAN  CLASS="textbf">Generate value</SPAN>. 

<P>
The <TT>CreateHierarchicalMGXAttribute</TT> node emits a hierarchical MGXAttribute for the initial data object,
with the corresponding AttributeType provided by loop 2 and the MGXAttribute's value obtained using loop 3.
Internally, loop 1 is used repetitively until the root node is reached, with all intermediary results
passing through loops 2 and 3, thus generating a single path of hierarchical attributes within the taxonomic
tree. The output of the <TT>CreateHierarchicalMGXAttribute</TT> is connected to the <TT>AnnotateAttribute</TT>
node as in the previous example.

<P>
For brevity's sake, several connections are hidden within the image, which have already been explained in the
previous section; the <TT>CreateMGXAttributeType</TT> node needs an incoming connection providing a MGXJob,
and the <TT>AnnotateAttribute</TT> node requires additional connections providing the sequence to be annotated
and start/stop coordinates for the subregion which is described by the annotation.

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html559"
  HREF="node35.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html555"
  HREF="node33.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html551"
  HREF="node33.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html557"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html560"
  HREF="node35.html">Bibliography</A>
<B> Up:</B> <A NAME="tex2html556"
  HREF="node33.html">Annotating metagenome sequences</A>
<B> Previous:</B> <A NAME="tex2html552"
  HREF="node33.html">Annotating metagenome sequences</A>
 &nbsp; <B>  <A NAME="tex2html558"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Sebastian Jaenicke, 2020-04-28
</ADDRESS>
</BODY>
</HTML>
